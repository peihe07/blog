+++
date = '2025-04-04'
draft = false
title = '物聯網專用協定'
categories = ['筆記']
tags = ['protocol']
+++

# CoAP (Constrained Application Protocol) 

- **設計目標**：
  * 專為資源受限設備設計（記憶體 < 10KB，Flash < 100KB）
  * Web 友善的 IoT 協定，類似 HTTP 但更輕量
  * 支援 UDP 和低功耗網路環境
- **協定特性**：
  * **基於 UDP**：減少連接開銷，適合間歇性通信
  * **預設端口**：5683 (非加密)、5684 (DTLS 加密)
  * **RESTful 設計**：支援 GET、POST、PUT、DELETE 方法
  * **二進制編碼**：比 HTTP 文本格式更高效
- **訊息類型**：
  * **Confirmable (CON)**：需要確認的可靠傳輸
  * **Non-confirmable (NON)**：不需確認的非可靠傳輸
  * **Acknowledgement (ACK)**：確認訊息
  * **Reset (RST)**：拒絕訊息
- **觀察機制 (Observe)**：
  * 類似 HTTP 長輪詢，但更高效
  * 客戶端訂閱資源變化
  * 伺服器主動推送更新
- **區塊傳輸 (Block Transfer)**：
  * 將大型訊息分割為小塊
  * 適應 UDP 封包大小限制
  * 支援流式傳輸
- **安全機制**：
  * **DTLS (Datagram TLS)**：UDP 上的 TLS
  * **PSK (Pre-Shared Key)**：預共享金鑰
  * **證書認證**：X.509 證書
- **實際應用**：
  * 智慧感測器網路
  * 低功耗監控系統
  * 智慧農業、環境監測
  * 與 HTTP 代理整合

# LoRaWAN (Long Range Wide Area Network) 

- **技術基礎**：
  * **LoRa 調變**：展頻調變技術，抗干擾能力強
  * **免執照頻段**：Sub-GHz ISM 頻段（868MHz 歐洲、915MHz 美國、433MHz 亞洲）
  * **長距離傳輸**：城市 2-5km，郊區 15km，視線可達 50km
- **網路架構**：
  * **終端設備 (End Device)**：感測器、執行器
  * **閘道 (Gateway)**：LoRa 到 IP 網路的橋接
  * **網路伺服器 (Network Server)**：管理網路和設備
  * **應用伺服器 (Application Server)**：處理業務邏輯
- **設備分類**：
  * **Class A**：最省電，僅在傳輸後開啟接收窗口
  * **Class B**：定期開啟接收窗口，支援下行排程
  * **Class C**：持續監聽，功耗最高但延遲最低
- **自適應資料速率 (ADR)**：
  * 動態調整傳輸參數
  * 平衡功耗、距離和資料速率
  * 網路容量最佳化
- **安全機制**：
  * **AES-128 加密**：應用層和網路層雙重加密
  * **設備認證**：DevEUI、AppEUI、AppKey
  * **會話金鑰**：動態生成網路和應用會話金鑰
- **應用場景**：
  * 智慧城市感測器網路
  * 農業物聯網
  * 資產追蹤
  * 智慧電表

# NB-IoT (Narrowband Internet of Things) 

- **技術特性**：
  * **3GPP 標準**：Release 13 引入，基於 LTE 技術
  * **窄頻設計**：僅需 180kHz 頻寬
  * **深度覆蓋**：比 LTE 增強 20dB，室內穿透力強
- **部署模式**：
  * **In-band**：LTE 頻段內部署
  * **Guard-band**：LTE 保護頻段部署
  * **Standalone**：獨立頻段部署（如 GSM 重整頻段）
- **技術優勢**：
  * **超低功耗**：電池壽命可達 10 年
  * **大規模連接**：單基站支援 5 萬個設備
  * **低成本**：模組成本 < $5
  * **深度覆蓋**：地下室、管道等環境
- **協定堆疊**：
  * **實體層**：OFDMA (下行)、SC-FDMA (上行)
  * **MAC 層**：簡化的 LTE MAC
  * **RRC 層**：輕量化的無線資源控制
  * **應用層**：CoAP、LwM2M、MQTT
- **電源管理**：
  * **PSM (Power Saving Mode)**：深度睡眠模式
  * **eDRX (Extended DRX)**：延長不連續接收週期
  * **早期資料傳輸**：減少信令開銷
- **實際應用**：
  * 智慧電表、水表
  * 煙霧偵測器
  * 土壤濕度監測
  * 停車場管理
  * 垃圾桶滿載偵測

# Zigbee

- **技術基礎**：
  * **IEEE 802.15.4**：實體層和 MAC 層標準
  * **2.4GHz 全球頻段**：16 個通道，支援跳頻
  * **網狀網路拓撲**：自組織、自修復網路
- **Zigbee 3.0 統一標準**：
  * 整合所有應用設定檔
  * 統一認證和加密機制
  * 跨廠商互通性
- **網路角色**：
  * **協調器 (Coordinator)**：網路管理者，唯一
  * **路由器 (Router)**：訊息轉發和網路擴展
  * **終端設備 (End Device)**：僅通信，不轉發
- **應用設定檔 (Application Profiles)**：
  * **ZHA (Zigbee Home Automation)**：家庭自動化
  * **ZLL (Zigbee Light Link)**：智慧照明
  * **ZCL (Zigbee Cluster Library)**：標準化設備類型
- **安全機制**：
  * **AES-128 加密**：鏈路層和網路層
  * **信任中心**：金鑰管理和設備認證
  * **安裝碼**：設備加入網路的安全機制
- **Green Power**：
  * 超低功耗設備支援
  * 能量收集設備（太陽能、動能）
  * 免電池開關和感測器
- **實際應用**：
  * 智慧家居控制系統
  * 智慧照明網路
  * 工業自動化
  * 建築能源管理

# Thread 

**深入學習筆記：**
- **設計理念**：
  * **IPv6 原生支援**：每個設備都有全球唯一 IP
  * **網狀網路**：基於 IEEE 802.15.4
  * **互聯網等級安全**：企業級安全機制
- **網路架構**：
  * **Thread 網路**：本地網狀網路
  * **邊界路由器**：連接到更廣泛的 IP 網路
  * **Thread 設備**：直接參與網狀網路
- **設備角色**：
  * **Leader**：管理網路配置和路由
  * **Router**：轉發訊息和擴展網路
  * **Router Eligible End Device (REED)**：可升級為路由器的終端設備
  * **Sleepy End Device (SED)**：低功耗睡眠設備
- **網路形成和管理**：
  * **自動網路形成**：無需手動配置
  * **自修復能力**：設備離開時自動重建路由
  * **分區恢復**：網路分割後自動合併
- **安全特性**：
  * **AES-128 加密**：所有通信加密
  * **企業級認證**：基於 IEEE 802.1X
  * **安全委託**：安全的設備加入機制
- **IPv6 整合**：
  * **6LoWPAN**：IPv6 over Low-Power Wireless
  * **全球 IPv6 位址**：直接網際網路連接
  * **標準 IP 協定**：UDP、TCP、CoAP、HTTP
- **實際應用**：
  * 智慧家居生態系統
  * 與 Matter 協定整合
  * 商業建築自動化
  * 工業 IoT 應用

## Matter (前身為 Project CHIP) 

- **標準化聯盟**：
  * **CSA (Connectivity Standards Alliance)**：主導組織
  * **主要成員**：Apple、Google、Amazon、Samsung、等
  * **開源實作**：GitHub 上的參考實作
- **互通性目標**：
  * **跨平台支援**：iOS、Android、Alexa、Google Assistant
  * **跨廠商相容**：不同品牌設備互通
  * **本地控制**：不依賴雲端服務
- **技術架構**：
  * **應用層協定**：統一的設備控制語言
  * **多傳輸支援**：WiFi、Thread、Bluetooth
  * **IPv6 基礎**：所有通信基於 IP 協定
- **設備類型支援**：
  * **照明**：智慧燈泡、開關、調光器
  * **HVAC**：溫度控制、空調系統
  * **安全**：門鎖、感測器、攝影機
  * **媒體**：電視、音響、串流設備
- **網路架構**：
  * **Matter 網路**：本地 IP 網路
  * **邊界路由器**：Thread 到 WiFi 橋接
  * **Matter Hub**：集中控制和管理
- **安全機制**：
  * **端到端加密**：設備間直接加密
  * **認證機制**：設備身份驗證
  * **安全委託**：設備安全加入網路
- **委託流程 (Commissioning)**：
  * **QR 碼掃描**：簡化設備加入
  * **設備發現**：自動發現附近設備
  * **網路配置**：自動連接到家庭網路

  # 物聯網協定選擇矩陣

| 協定 | 功耗 | 距離 | 頻寬 | 成本 | 適用場景 |
|------|------|------|------|------|----------|
| CoAP | 低 | 短 | 低 | 低 | 智慧感測器 |
| LoRaWAN | 極低 | 長 | 極低 | 中 | 廣域感測網路 |
| NB-IoT | 低 | 長 | 低 | 中 | 智慧電表 |
| Zigbee | 低 | 中 | 中 | 低 | 智慧家居 |
| Thread | 低 | 中 | 中 | 中 | 新一代智慧家居 |
| Matter | - | - | - | - | 跨平台智慧家居 |